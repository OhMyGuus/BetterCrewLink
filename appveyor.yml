version: '{build}'

cache:
  - node_modules

image:
  - Visual Studio 2019

install:
  - yarn install --network-timeout 100000

build_script:
  - yarn run dist --publish never

matrix:
  fast_finish: true
clone_depth: 1

on_success:
  - ps: Invoke-RestMethod https://raw.githubusercontent.com/DiscordHooks/appveyor-discord-webhook/master/send.ps1 -o send.ps1
  - ps: ./send.ps1 success $env:WEBHOOK_URL
on_failure:
  - ps: Invoke-RestMethod https://raw.githubusercontent.com/DiscordHooks/appveyor-discord-webhook/master/send.ps1 -o send.ps1
  - ps: ./send.ps1 failure $env:WEBHOOK_URL

artifacts:
  - path: dist/win-unpacked
    name: unpacked
    type: zip
  - path: 'dist/Better-CrewLink Setup*.exe'
    name: installer
    type: exe

